<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Beerus | Beerus</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="A web solution developed in golang">
    
    <link rel="preload" href="/assets/css/0.styles.cd3a2423.css" as="style"><link rel="preload" href="/assets/js/app.dd5e7c59.js" as="script"><link rel="preload" href="/assets/js/2.67bc9379.js" as="script"><link rel="preload" href="/assets/js/8.900c75d8.js" as="script"><link rel="prefetch" href="/assets/js/10.3c764716.js"><link rel="prefetch" href="/assets/js/11.576ccd84.js"><link rel="prefetch" href="/assets/js/3.b3f0d358.js"><link rel="prefetch" href="/assets/js/4.d4647f7b.js"><link rel="prefetch" href="/assets/js/5.f326f682.js"><link rel="prefetch" href="/assets/js/6.cee21277.js"><link rel="prefetch" href="/assets/js/7.7e380a7a.js"><link rel="prefetch" href="/assets/js/9.8b9cb152.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cd3a2423.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Beerus</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://github.com/yuyenews" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/yuyenews/Beerus/discussions" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discussions
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://t.me/beeruscc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Telegram
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/sponsor/sponsor.html" class="nav-link">
  Sponsor
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Document" class="dropdown-title"><span class="title">Document</span> <span class="arrow down"></span></button> <button type="button" aria-label="Document" class="mobile-dropdown-title"><span class="title">Document</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/beerus/index.html" class="nav-link">
  Beerus
</a></li><li class="dropdown-item"><!----> <a href="/beerusdb/index.html" class="nav-link">
  Beerus-db
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Languages" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://beeruscc.com/cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简体中文
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://beeruscc.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  English
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://github.com/yuyenews" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/yuyenews/Beerus/discussions" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discussions
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://t.me/beeruscc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Telegram
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/sponsor/sponsor.html" class="nav-link">
  Sponsor
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Document" class="dropdown-title"><span class="title">Document</span> <span class="arrow down"></span></button> <button type="button" aria-label="Document" class="mobile-dropdown-title"><span class="title">Document</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/beerus/index.html" class="nav-link">
  Beerus
</a></li><li class="dropdown-item"><!----> <a href="/beerusdb/index.html" class="nav-link">
  Beerus-db
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Languages" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://beeruscc.com/cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简体中文
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://beeruscc.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  English
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Beerus</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/beerus/#installing-dependencies" class="sidebar-link">Installing dependencies</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/beerus/#the-underlying-technology-used" class="sidebar-link">The underlying technology used</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/beerus/#http-service" class="sidebar-link">HTTP Service</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/beerus/#create-route" class="sidebar-link">Create Route</a></li><li class="sidebar-sub-header"><a href="/beerus/#using-the-traditional-way-of-getting-parameters" class="sidebar-link">Using the traditional way of getting parameters</a></li><li class="sidebar-sub-header"><a href="/beerus/#extract-parameters-directly-to-struct" class="sidebar-link">Extract parameters directly to struct</a></li><li class="sidebar-sub-header"><a href="/beerus/#launching-services" class="sidebar-link">Launching services</a></li><li class="sidebar-sub-header"><a href="/beerus/#parameter-validation" class="sidebar-link">Parameter validation</a></li><li class="sidebar-sub-header"><a href="/beerus/#returning-data-to-the-client" class="sidebar-link">Returning data to the client</a></li><li class="sidebar-sub-header"><a href="/beerus/#interceptors" class="sidebar-link">Interceptors</a></li><li class="sidebar-sub-header"><a href="/beerus/#session-management" class="sidebar-link">Session management</a></li></ul></li><li><a href="/beerus/#websocket-service" class="sidebar-link">WebSocket Service</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/beerus/#create-route-2" class="sidebar-link">Create route</a></li><li class="sidebar-sub-header"><a href="/beerus/#launching-services-2" class="sidebar-link">Launching services</a></li></ul></li><li><a href="/beerus/#udp-service" class="sidebar-link">UDP Service</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/beerus/#launching-services-3" class="sidebar-link">Launching services</a></li></ul></li><li><a href="/beerus/#database-operations" class="sidebar-link">Database operations</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="beerus"><a href="#beerus" class="header-anchor">#</a> Beerus</h1> <h2 id="installing-dependencies"><a href="#installing-dependencies" class="header-anchor">#</a> Installing dependencies</h2> <div class="language-shell extra-class"><pre class="language-shell"><code>go get github.com/yuyenews/Beerus
</code></pre></div><h2 id="the-underlying-technology-used"><a href="#the-underlying-technology-used" class="header-anchor">#</a> The underlying technology used</h2> <ul><li>http uses the net/http package that comes with go, and extends the way routes are managed on top of it.</li> <li>WebSocket is an extension of http, the framework itself implements the protocol upgrade, message listening, message parsing, message sending and other functions</li> <li>udp is developed based on the net package, with a simple secondary wrapper</li></ul> <p>In addition to the underlying technologies described above, there are many other extensions, which you can learn about by reading the documentation below</p> <h2 id="http-service"><a href="#http-service" class="header-anchor">#</a> HTTP Service</h2> <h3 id="create-route"><a href="#create-route" class="header-anchor">#</a> Create Route</h3> <ul><li>Simply call the functions below the route, choosing the most appropriate function for the type of request you need</li> <li>The first parameter is the URL of the route, which is the address requested by the front-end</li> <li>The second parameter is a function that will be automatically executed by the server when the front-end requests this URL</li></ul> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">CreateRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// post route example</span>
    route<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">&quot;/example/post&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span> <span class="token punctuation">(</span>req <span class="token operator">*</span>commons<span class="token punctuation">.</span>BeeRequest<span class="token punctuation">,</span> res <span class="token operator">*</span>commons<span class="token punctuation">.</span>BeeResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
        res<span class="token punctuation">.</span><span class="token function">SendJson</span><span class="token punctuation">(</span><span class="token string">`{&quot;msg&quot;:&quot;SUCCESS&quot;}`</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// get route example</span>
    route<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/example/get&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span> <span class="token punctuation">(</span>req <span class="token operator">*</span>commons<span class="token punctuation">.</span>BeeRequest<span class="token punctuation">,</span> res <span class="token operator">*</span>commons<span class="token punctuation">.</span>BeeResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
        res<span class="token punctuation">.</span><span class="token function">SendJson</span><span class="token punctuation">(</span><span class="token string">`{&quot;msg&quot;:&quot;SUCCESS&quot;}`</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="using-the-traditional-way-of-getting-parameters"><a href="#using-the-traditional-way-of-getting-parameters" class="header-anchor">#</a> Using the traditional way of getting parameters</h3> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// Get the parameters from the front end, regardless of the request method</span>
req<span class="token punctuation">.</span><span class="token function">FormValue</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// Get the request header from the front end, regardless of the request method</span>
req<span class="token punctuation">.</span><span class="token function">HeaderValue</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// Get the file from the front-end, form-data only</span>
req<span class="token punctuation">.</span><span class="token function">GetFile</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// Get the json string passed as json</span>
req<span class="token punctuation">.</span>Json
</code></pre></div><h3 id="extract-parameters-directly-to-struct"><a href="#extract-parameters-directly-to-struct" class="header-anchor">#</a> Extract parameters directly to struct</h3> <p>First, you need to define a struct, The matching rules are as follows</p> <ul><li>If the field attribute is set in the tag, it will be matched against the field first, if not then it will be matched against the field name again.</li> <li>The supported types are shown in the following examples</li> <li>commons.BeeFile type Only works on formdata</li> <li>[]string Only works with json</li></ul> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// DemoParam If you have a struct like this, and you want to put all the parameters from the request into this struct</span>
<span class="token keyword">type</span> DemoParam <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	<span class="token comment">// You can customize any field</span>
	<span class="token comment">// the name of the field must be exactly the same as the name of the requested parameter, and is case-sensitive</span>
	TestStringReception    <span class="token builtin">string</span>  <span class="token string">`field:&quot;testStringReception&quot;`</span>
	TestIntReception       <span class="token builtin">int</span>     <span class="token string">`field:&quot;testIntReception&quot;`</span>
	TestInt64Reception     <span class="token builtin">int64</span>   
	TestUintReception      <span class="token builtin">uint</span>    
	TestUint32Reception    <span class="token builtin">uint32</span>  
	TestUint64Reception    <span class="token builtin">uint64</span>  
	TestFloatReception     <span class="token builtin">float32</span> 
	TestStringRegReception <span class="token builtin">string</span>  
	TestBoolReception      <span class="token builtin">bool</span>

	TestBeeFileReception   commons<span class="token punctuation">.</span>BeeFile

	TestJsonReception <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Then, call the params.ToStruct function to extract all the parameters from req to struct</p> <ul><li>The first argument is req</li> <li>the second argument is a pointer to struct</li> <li>The third argument is the value of struct</li></ul> <p>When the params.ToStruct function is finished, there will be data in param</p> <div class="language-go extra-class"><pre class="language-go"><code>param <span class="token operator">:=</span> DemoParam<span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// Extraction parameters, Generally used in scenarios where verification is not required or you want to verify manually</span>
params<span class="token punctuation">.</span><span class="token function">ToStruct</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token operator">&amp;</span>param<span class="token punctuation">,</span> param<span class="token punctuation">)</span>
</code></pre></div><h3 id="launching-services"><a href="#launching-services" class="header-anchor">#</a> Launching services</h3> <p>You need to call the route creation function manually</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    
    <span class="token comment">// Interceptors, routes, etc. Loading of data requires its own calls</span>
    routes<span class="token punctuation">.</span><span class="token function">CreateRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">// Listen the service and listen to port 8080</span>
    beerus<span class="token punctuation">.</span><span class="token function">ListenHTTP</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Once the service is started, it can be accessed normally, by http://ip:port/routePath</p> <h3 id="parameter-validation"><a href="#parameter-validation" class="header-anchor">#</a> Parameter validation</h3> <p>To achieve automatic parameter validation, the parameters must first be extracted to struct, and the validation method is simple, see the following example</p> <ul><li>notnull: Set to true to indicate that this parameter must not be empty</li> <li>reg: Write your own regular expression that fails to validate when it does not match.</li> <li>max: Maximum value of the field</li> <li>min: Minimum value of the field</li> <li>msg: The message returned when the verification does not pass</li> <li>notnull, reg valid only for string, max, min valid only for numeric fields</li> <li>routes: Used to set which routes this validation is valid for, multiple comma-separated, supports * wildcards</li></ul> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> DemoParam <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	<span class="token comment">// You can customize any field</span>
	<span class="token comment">// the name of the field must be exactly the same as the name of the requested parameter, and is case-sensitive</span>
	TestStringReception    <span class="token builtin">string</span>  <span class="token string">`notnull:&quot;true&quot; msg:&quot;TestStringReception Cannot be empty&quot; routes:&quot;/example/put&quot;`</span>
	TestIntReception       <span class="token builtin">int</span>     <span class="token string">`max:&quot;123&quot; min:&quot;32&quot; msg:&quot;TestIntReception The value range must be between 32 - 123&quot; routes:&quot;/example/post&quot;`</span>
	TestInt64Reception     <span class="token builtin">int64</span>   <span class="token string">`max:&quot;123&quot; min:&quot;32&quot; msg:&quot;TestInt64Reception The value range must be between 32 - 123&quot;`</span>
	TestUintReception      <span class="token builtin">uint</span>    <span class="token string">`max:&quot;123&quot; min:&quot;32&quot; msg:&quot;TestUintReception The value range must be between 32 - 123&quot;`</span>
	TestUint32Reception    <span class="token builtin">uint32</span>  <span class="token string">`max:&quot;123&quot; min:&quot;32&quot; msg:&quot;TTestUint32Reception The value range must be between 32 - 123&quot;`</span>
	TestUint64Reception    <span class="token builtin">uint64</span>  <span class="token string">`max:&quot;123&quot; min:&quot;32&quot; msg:&quot;TestUint64Reception The value range must be between 32 - 123&quot;`</span>
	TestFloatReception     <span class="token builtin">float32</span> <span class="token string">`max:&quot;123&quot; min:&quot;32&quot; msg:&quot;TestFloatReception The value range must be between 32 - 123&quot;`</span>
	TestStringRegReception <span class="token builtin">string</span>  <span class="token string">`reg:&quot;^[a-z]+$&quot; msg:&quot;TestStringRegReception Does not meet the regular&quot;`</span>
<span class="token punctuation">}</span>
</code></pre></div><p>For the above configuration to take effect, one more thing must be done, see the following example and pay attention to the comments</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// Call the params.Validation function and perform validation</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">Validation</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token operator">&amp;</span>param<span class="token punctuation">,</span> param<span class="token punctuation">)</span>
<span class="token comment">// When the return is not SUCCESS, it means that the authentication did not pass</span>
<span class="token keyword">if</span> result <span class="token operator">!=</span> params<span class="token punctuation">.</span>SUCCESS <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">SendErrorMsg</span><span class="token punctuation">(</span><span class="token number">1128</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token comment">// There is also a one-step approach, calling the params.ToStructAndValidation function</span>
<span class="token comment">// Extraction of parameters + data validation in one step</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">ToStructAndValidation</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token operator">&amp;</span>param<span class="token punctuation">,</span> param<span class="token punctuation">)</span>
<span class="token keyword">if</span> result <span class="token operator">!=</span> params<span class="token punctuation">.</span>SUCCESS <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">SendErrorMsg</span><span class="token punctuation">(</span><span class="token number">1128</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="returning-data-to-the-client"><a href="#returning-data-to-the-client" class="header-anchor">#</a> Returning data to the client</h3> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// Return json to client</span>
res<span class="token punctuation">.</span><span class="token function">SendJson</span><span class="token punctuation">(</span><span class="token string">&quot;json&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// Return text to client</span>
res<span class="token punctuation">.</span><span class="token function">SendText</span><span class="token punctuation">(</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// Return html to client</span>
res<span class="token punctuation">.</span><span class="token function">SendHtml</span><span class="token punctuation">(</span><span class="token string">&quot;html text&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// Returning files to the client</span>
res<span class="token punctuation">.</span><span class="token function">SendStream</span><span class="token punctuation">(</span><span class="token string">&quot;filename&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span>

<span class="token comment">// Return other custom content-type data to the client</span>
res<span class="token punctuation">.</span><span class="token function">SendData</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="interceptors"><a href="#interceptors" class="header-anchor">#</a> Interceptors</h3> <ul><li>Creating an interceptor is particularly similar to creating a route, just call the route.AddInterceptor function</li> <li>The first parameter is the path of the route to be intercepted and supports * wildcards</li> <li>The second parameter is a function that implements the interceptor logic</li> <li>If it is allowed, it returns SUCCESS, otherwise it returns a prompt message</li> <li>As with the route, the CreateInterceptor function needs to be called in the main function</li></ul> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// This function needs to be called in the main function</span>
<span class="token keyword">func</span> <span class="token function">CreateInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	route<span class="token punctuation">.</span><span class="token function">AddInterceptor</span><span class="token punctuation">(</span><span class="token string">&quot;/example/*&quot;</span><span class="token punctuation">,</span> loginInterceptorBefore<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">loginInterceptorBefore</span><span class="token punctuation">(</span>req <span class="token operator">*</span>commons<span class="token punctuation">.</span>BeeRequest<span class="token punctuation">,</span> res <span class="token operator">*</span>commons<span class="token punctuation">.</span>BeeResponse<span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
	res<span class="token punctuation">.</span><span class="token function">SetHeader</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello word&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetHeader</span><span class="token punctuation">(</span><span class="token string">&quot;hello2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;word2&quot;</span><span class="token punctuation">)</span>

	log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;exec interceptor&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> params<span class="token punctuation">.</span>SUCCESS
<span class="token punctuation">}</span>
</code></pre></div><h3 id="session-management"><a href="#session-management" class="header-anchor">#</a> Session management</h3> <p>You need to create a session first</p> <ul><li>Secret: encryption key, length must be = 32</li> <li>InitializationVector: initialization constant, length must be = 16</li> <li>Timeout: duration of the session, in milliseconds</li></ul> <div class="language-go extra-class"><pre class="language-go"><code>session <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>commons<span class="token punctuation">.</span>BeeSession<span class="token punctuation">)</span>
session<span class="token punctuation">.</span>Secret <span class="token operator">=</span> <span class="token string">&quot;12345678abcdefgh09876543alnkdjfh&quot;</span>
session<span class="token punctuation">.</span>InitializationVector <span class="token operator">=</span> <span class="token string">&quot;12345678qwertyui&quot;</span>
session<span class="token punctuation">.</span>Timeout <span class="token operator">=</span> <span class="token number">3000</span>
</code></pre></div><p>Then you can use the session to create a token</p> <ul><li>Give the token to the front-end, which will bring it back with each request</li></ul> <div class="language-go extra-class"><pre class="language-go"><code>demo <span class="token operator">:=</span> Demo<span class="token punctuation">{</span><span class="token punctuation">}</span>
demo<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;Beerus&quot;</span>
demo<span class="token punctuation">.</span>Age <span class="token operator">=</span> <span class="token number">18</span>
demo<span class="token punctuation">.</span>Height <span class="token operator">=</span> <span class="token number">180</span>

token<span class="token punctuation">,</span> err <span class="token operator">:=</span> session<span class="token punctuation">.</span><span class="token function">CreateToken</span><span class="token punctuation">(</span>demo<span class="token punctuation">)</span>
</code></pre></div><p>Restore the token to its original data</p> <div class="language-go extra-class"><pre class="language-go"><code>demo2 <span class="token operator">:=</span> Demo<span class="token punctuation">{</span><span class="token punctuation">}</span>
err <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">RestoreToken</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> <span class="token operator">&amp;</span>demo2<span class="token punctuation">)</span>
</code></pre></div><p><a href="/beerus/session.html">Details</a></p> <h2 id="websocket-service"><a href="#websocket-service" class="header-anchor">#</a> WebSocket Service</h2> <h3 id="create-route-2"><a href="#create-route-2" class="header-anchor">#</a> Create route</h3> <ul><li>Only three functions are used here, in practice it is possible to use three different functions for each route</li> <li>The first parameter session: there are just two elements in it, an ID and a SendString, Send function</li> <li>The second parameter msg: is the message sent by the client, which can be used directly</li></ul> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// CreateWebSocketRoute Creating websocket routes</span>
<span class="token keyword">func</span> <span class="token function">CreateWebSocketRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	route<span class="token punctuation">.</span><span class="token function">AddWebSocketRoute</span><span class="token punctuation">(</span><span class="token string">&quot;/ws/test&quot;</span><span class="token punctuation">,</span> onConnection<span class="token punctuation">,</span> onMessage<span class="token punctuation">,</span> onClose<span class="token punctuation">)</span>
	route<span class="token punctuation">.</span><span class="token function">AddWebSocketRoute</span><span class="token punctuation">(</span><span class="token string">&quot;/ws/test2&quot;</span><span class="token punctuation">,</span> onConnection<span class="token punctuation">,</span> onMessage<span class="token punctuation">,</span> onClose<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// In order to save time, only three functions are used below. In practice, you can configure a set of functions for each route</span>

<span class="token keyword">func</span> <span class="token function">onConnection</span><span class="token punctuation">(</span>session <span class="token operator">*</span>params<span class="token punctuation">.</span>WebSocketSession<span class="token punctuation">,</span> msg <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span>msg <span class="token operator">+</span> <span class="token string">&quot;-------------------------------&quot;</span><span class="token punctuation">)</span>
	session<span class="token punctuation">.</span><span class="token function">SendString</span><span class="token punctuation">(</span><span class="token string">&quot;connection success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">onMessage</span><span class="token punctuation">(</span>session <span class="token operator">*</span>params<span class="token punctuation">.</span>WebSocketSession<span class="token punctuation">,</span> msg <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span>msg <span class="token operator">+</span> <span class="token string">&quot;-------------------------------&quot;</span><span class="token punctuation">)</span>
	session<span class="token punctuation">.</span><span class="token function">SendString</span><span class="token punctuation">(</span><span class="token string">&quot;I got the message.&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">onClose</span><span class="token punctuation">(</span>session <span class="token operator">*</span>params<span class="token punctuation">.</span>WebSocketSession<span class="token punctuation">,</span> msg <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span>msg <span class="token operator">+</span> <span class="token string">&quot;-------------------------------&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="launching-services-2"><a href="#launching-services-2" class="header-anchor">#</a> Launching services</h3> <p>You need to call the route creation function manually, the service started is still an HTTP service</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    
    <span class="token comment">// Interceptors, routes, etc. Loading of data requires its own calls</span>
    routes<span class="token punctuation">.</span><span class="token function">CreateWebSocketRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">// Listen the service and listen to port 8080</span>
    beerus<span class="token punctuation">.</span><span class="token function">ListenHTTP</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Once started, you can launch WebSocket communication normally, with the connection method: ws://ip:port/route path</p> <h2 id="udp-service"><a href="#udp-service" class="header-anchor">#</a> UDP Service</h2> <h3 id="launching-services-3"><a href="#launching-services-3" class="header-anchor">#</a> Launching services</h3> <ul><li>There is no concept of routing, only a function to receive data</li> <li>The first parameter is the handler</li> <li>The second parameter is the data separator</li> <li>The third parameter is the port</li></ul> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token comment">// Listening to a UDP service</span>
	<span class="token comment">// The first parameter is the handler</span>
	<span class="token comment">// The second parameter is the data separator</span>
	<span class="token comment">// The third parameter is the port</span>
	beerus<span class="token punctuation">.</span><span class="token function">ListenUDP</span><span class="token punctuation">(</span>updHandler<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;|&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">updHandler</span><span class="token punctuation">(</span>data <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// data is the data you received</span>
	<span class="token function">println</span><span class="token punctuation">(</span>util<span class="token punctuation">.</span><span class="token function">BytesToString</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Once the data is received, it can be converted directly to string</p> <h2 id="database-operations"><a href="#database-operations" class="header-anchor">#</a> Database operations</h2> <p><a href="/beerusdb/index.html">Click here -&gt; Database operations</a></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.dd5e7c59.js" defer></script><script src="/assets/js/2.67bc9379.js" defer></script><script src="/assets/js/8.900c75d8.js" defer></script>
  </body>
</html>
