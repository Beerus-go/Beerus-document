<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Beerus | Beerus</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="用Go语言开发的Web解决方案">
    
    <link rel="preload" href="/cn/assets/css/0.styles.e8732725.css" as="style"><link rel="preload" href="/cn/assets/js/app.fb26b1ce.js" as="script"><link rel="preload" href="/cn/assets/js/2.67bc9379.js" as="script"><link rel="preload" href="/cn/assets/js/8.282612f2.js" as="script"><link rel="prefetch" href="/cn/assets/js/10.15a1a5d5.js"><link rel="prefetch" href="/cn/assets/js/11.0a7ddcab.js"><link rel="prefetch" href="/cn/assets/js/3.b3f0d358.js"><link rel="prefetch" href="/cn/assets/js/4.96e9b071.js"><link rel="prefetch" href="/cn/assets/js/5.c776c5b5.js"><link rel="prefetch" href="/cn/assets/js/6.cee21277.js"><link rel="prefetch" href="/cn/assets/js/7.6f071a72.js"><link rel="prefetch" href="/cn/assets/js/9.f2f13d20.js">
    <link rel="stylesheet" href="/cn/assets/css/0.styles.e8732725.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/cn/" class="home-link router-link-active"><!----> <span class="site-name">Beerus</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/cn/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="https://github.com/yuyenews" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/yuyenews/Beerus/discussions" target="_blank" rel="noopener noreferrer" class="nav-link external">
  社区
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://t.me/beeruscc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Telegram
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/cn/sponsor/sponsor.html" class="nav-link">
  赞助
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档" class="dropdown-title"><span class="title">文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="文档" class="mobile-dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cn/beerus/index.html" class="nav-link">
  Beerus
</a></li><li class="dropdown-item"><!----> <a href="/cn/beerusdb/index.html" class="nav-link">
  Beerus-db
</a></li></ul></div></div><div class="nav-item"><a href="https://www.bilibili.com/video/BV1cZ4y1X79f" target="_blank" rel="noopener noreferrer" class="nav-link external">
  视频演示
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Languages" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://beeruscc.com/cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简体中文
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://beeruscc.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  English
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://magician-io.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/cn/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="https://github.com/yuyenews" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/yuyenews/Beerus/discussions" target="_blank" rel="noopener noreferrer" class="nav-link external">
  社区
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://t.me/beeruscc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Telegram
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/cn/sponsor/sponsor.html" class="nav-link">
  赞助
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档" class="dropdown-title"><span class="title">文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="文档" class="mobile-dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cn/beerus/index.html" class="nav-link">
  Beerus
</a></li><li class="dropdown-item"><!----> <a href="/cn/beerusdb/index.html" class="nav-link">
  Beerus-db
</a></li></ul></div></div><div class="nav-item"><a href="https://www.bilibili.com/video/BV1cZ4y1X79f" target="_blank" rel="noopener noreferrer" class="nav-link external">
  视频演示
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Languages" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://beeruscc.com/cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简体中文
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://beeruscc.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  English
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://magician-io.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Beerus</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/cn/beerus/#安装依赖" class="sidebar-link">安装依赖</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/cn/beerus/#架构组成" class="sidebar-link">架构组成</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/cn/beerus/#http服务" class="sidebar-link">HTTP服务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cn/beerus/#创建路由" class="sidebar-link">创建路由</a></li><li class="sidebar-sub-header"><a href="/cn/beerus/#传统的方式获取参数" class="sidebar-link">传统的方式获取参数</a></li><li class="sidebar-sub-header"><a href="/cn/beerus/#直接将参数提取到struct" class="sidebar-link">直接将参数提取到struct</a></li><li class="sidebar-sub-header"><a href="/cn/beerus/#启动服务" class="sidebar-link">启动服务</a></li><li class="sidebar-sub-header"><a href="/cn/beerus/#参数验证" class="sidebar-link">参数验证</a></li><li class="sidebar-sub-header"><a href="/cn/beerus/#响应数据" class="sidebar-link">响应数据</a></li><li class="sidebar-sub-header"><a href="/cn/beerus/#拦截器" class="sidebar-link">拦截器</a></li><li class="sidebar-sub-header"><a href="/cn/beerus/#会话管理" class="sidebar-link">会话管理</a></li></ul></li><li><a href="/cn/beerus/#websocket-服务" class="sidebar-link">WebSocket 服务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cn/beerus/#创建路由-2" class="sidebar-link">创建路由</a></li><li class="sidebar-sub-header"><a href="/cn/beerus/#启动服务-2" class="sidebar-link">启动服务</a></li></ul></li><li><a href="/cn/beerus/#udp服务" class="sidebar-link">UDP服务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cn/beerus/#启动服务-3" class="sidebar-link">启动服务</a></li></ul></li><li><a href="/cn/beerus/#数据库操作" class="sidebar-link">数据库操作</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="beerus"><a href="#beerus" class="header-anchor">#</a> Beerus</h1> <h2 id="安装依赖"><a href="#安装依赖" class="header-anchor">#</a> 安装依赖</h2> <div class="language-shell extra-class"><pre class="language-shell"><code>go get github.com/yuyenews/Beerus@v1.1.3
</code></pre></div><h2 id="架构组成"><a href="#架构组成" class="header-anchor">#</a> 架构组成</h2> <ul><li>http直接使用的go自带的net/http包，在此基础上扩展了路由的管理方式</li> <li>WebSocket 在http的基础上做的扩展，实现了协议升级，消息监听，报文解析，消息发送 等功能</li> <li>udp 基于net包开发的，做了一个简单的二次封装</li></ul> <p>除了上面介绍的这些依赖的底层的技术，还扩展了很多功能，大家可以看下面的文档慢慢了解</p> <h2 id="http服务"><a href="#http服务" class="header-anchor">#</a> HTTP服务</h2> <h3 id="创建路由"><a href="#创建路由" class="header-anchor">#</a> 创建路由</h3> <ul><li>直接调用route 下面的函数即可，需要什么请求方式 就调用什么请求方式的函数</li> <li>第一个参数是路由的URL，就是前端请求的地址</li> <li>第二个参数是 一个函数，当前端请求这个URL，服务端就会自动执行这个函数</li></ul> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">CreateRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// post route example</span>
    route<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">&quot;/example/post&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span> <span class="token punctuation">(</span>req <span class="token operator">*</span>commons<span class="token punctuation">.</span>BeeRequest<span class="token punctuation">,</span> res <span class="token operator">*</span>commons<span class="token punctuation">.</span>BeeResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
        res<span class="token punctuation">.</span><span class="token function">SendJson</span><span class="token punctuation">(</span><span class="token string">`{&quot;msg&quot;:&quot;SUCCESS&quot;}`</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// get route example</span>
    route<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/example/get&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span> <span class="token punctuation">(</span>req <span class="token operator">*</span>commons<span class="token punctuation">.</span>BeeRequest<span class="token punctuation">,</span> res <span class="token operator">*</span>commons<span class="token punctuation">.</span>BeeResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
        res<span class="token punctuation">.</span><span class="token function">SendJson</span><span class="token punctuation">(</span><span class="token string">`{&quot;msg&quot;:&quot;SUCCESS&quot;}`</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="传统的方式获取参数"><a href="#传统的方式获取参数" class="header-anchor">#</a> 传统的方式获取参数</h3> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// 可以获取到前端传来的参数，不限请求方式</span>
req<span class="token punctuation">.</span><span class="token function">FormValue</span><span class="token punctuation">(</span><span class="token string">&quot;参数name&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// 可以获取到前端传来的多个同名参数，返回一个数组，只对：普通表单，json，get请求 生效，formData是无效的</span>
req<span class="token punctuation">.</span><span class="token function">FormValues</span><span class="token punctuation">(</span><span class="token string">&quot;参数name&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// 可以获取到前端传来的请求头，不限请求方式</span>
req<span class="token punctuation">.</span><span class="token function">HeaderValue</span><span class="token punctuation">(</span><span class="token string">&quot;请求头name&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// 可以获取前端传来的文件，仅限 form-data</span>
req<span class="token punctuation">.</span><span class="token function">GetFile</span><span class="token punctuation">(</span><span class="token string">&quot;参数name&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// 可以获取到以json传参的 json字符串</span>
req<span class="token punctuation">.</span>Json
</code></pre></div><h3 id="直接将参数提取到struct"><a href="#直接将参数提取到struct" class="header-anchor">#</a> 直接将参数提取到struct</h3> <p>首先需要定一个struct，匹配规则如下</p> <ul><li>如果tag里面设置了field属性，会优先根据field去匹配，如果没匹配到 那么会根据字段名再匹配一次</li> <li>支持的类型，都在下面的示例中了</li> <li>commons.BeeFile 类型 只对 formdata生效</li> <li>[]string 只对：普通表单，json，get请求 生效，formData是无效的</li></ul> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// DemoParam If you have a struct like this, and you want to put all the parameters from the request into this struct</span>
<span class="token keyword">type</span> DemoParam <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	<span class="token comment">// You can customize any field</span>
	<span class="token comment">// the name of the field must be exactly the same as the name of the requested parameter, and is case-sensitive</span>
	TestStringReception    <span class="token builtin">string</span>  <span class="token string">`field:&quot;testStringReception&quot;`</span>
	TestIntReception       <span class="token builtin">int</span>     <span class="token string">`field:&quot;testIntReception&quot;`</span>
	TestInt64Reception     <span class="token builtin">int64</span>   
	TestUintReception      <span class="token builtin">uint</span>    
	TestUint32Reception    <span class="token builtin">uint32</span>  
	TestUint64Reception    <span class="token builtin">uint64</span>  
	TestFloatReception     <span class="token builtin">float32</span> 
	TestStringRegReception <span class="token builtin">string</span>  
	TestBoolReception      <span class="token builtin">bool</span>

	TestBeeFileReception   commons<span class="token punctuation">.</span>BeeFile

	TestArrayReception <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然后，调用 params.ToStruct函数 将req里面的参数全部提取到struct</p> <ul><li>第一个参数是req</li> <li>第二个参数是 struct的指针</li> <li>第三个参数是 struct的值</li></ul> <p>当执行完 params.ToStruct函数，param里就会有数据了</p> <div class="language-go extra-class"><pre class="language-go"><code>param <span class="token operator">:=</span> DemoParam<span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// Extraction parameters, Generally used in scenarios where verification is not required or you want to verify manually</span>
params<span class="token punctuation">.</span><span class="token function">ToStruct</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token operator">&amp;</span>param<span class="token punctuation">,</span> param<span class="token punctuation">)</span>
</code></pre></div><h3 id="启动服务"><a href="#启动服务" class="header-anchor">#</a> 启动服务</h3> <p>需要手动调用一下 创建路由的函数</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    
    <span class="token comment">// Interceptors, routes, etc. Loading of data requires its own calls</span>
    routes<span class="token punctuation">.</span><span class="token function">CreateRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">// Listen the service and listen to port 8080</span>
    beerus<span class="token punctuation">.</span><span class="token function">ListenHTTP</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>服务启动后，前端即可正常访问，访问方式： http://ip:port/路由地址</p> <h3 id="参数验证"><a href="#参数验证" class="header-anchor">#</a> 参数验证</h3> <p>想要实现自动验证参数，必须使用将参数提取到struct的方式来接收参数，验证方法也很简单，看如下示例</p> <ul><li>notnull: 设置成true，说明这个参数不可以为空</li> <li>reg: 自己写正则进行验证，当不匹配时说明没通过验证</li> <li>max: 字段的最大取值</li> <li>min: 字段的最小取值</li> <li>msg: 当验证没通过时，返回的提示消息</li> <li>其中: notnull，reg 仅对 string有效，max，min 仅对数字类型的字段有效</li> <li>routes: 用来设置 这个验证对那些路由有效，多个用逗号分割，支持*通配符</li></ul> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> DemoParam <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	<span class="token comment">// You can customize any field</span>
	<span class="token comment">// the name of the field must be exactly the same as the name of the requested parameter, and is case-sensitive</span>
	TestStringReception    <span class="token builtin">string</span>  <span class="token string">`notnull:&quot;true&quot; msg:&quot;TestStringReception Cannot be empty&quot; routes:&quot;/example/put&quot;`</span>
	TestIntReception       <span class="token builtin">int</span>     <span class="token string">`max:&quot;123&quot; min:&quot;32&quot; msg:&quot;TestIntReception The value range must be between 32 - 123&quot; routes:&quot;/example/post&quot;`</span>
	TestInt64Reception     <span class="token builtin">int64</span>   <span class="token string">`max:&quot;123&quot; min:&quot;32&quot; msg:&quot;TestInt64Reception The value range must be between 32 - 123&quot;`</span>
	TestUintReception      <span class="token builtin">uint</span>    <span class="token string">`max:&quot;123&quot; min:&quot;32&quot; msg:&quot;TestUintReception The value range must be between 32 - 123&quot;`</span>
	TestUint32Reception    <span class="token builtin">uint32</span>  <span class="token string">`max:&quot;123&quot; min:&quot;32&quot; msg:&quot;TTestUint32Reception The value range must be between 32 - 123&quot;`</span>
	TestUint64Reception    <span class="token builtin">uint64</span>  <span class="token string">`max:&quot;123&quot; min:&quot;32&quot; msg:&quot;TestUint64Reception The value range must be between 32 - 123&quot;`</span>
	TestFloatReception     <span class="token builtin">float32</span> <span class="token string">`max:&quot;123&quot; min:&quot;32&quot; msg:&quot;TestFloatReception The value range must be between 32 - 123&quot;`</span>
	TestStringRegReception <span class="token builtin">string</span>  <span class="token string">`reg:&quot;^[a-z]+$&quot; msg:&quot;TestStringRegReception Does not meet the regular&quot;`</span>
<span class="token punctuation">}</span>
</code></pre></div><p>要让上面的配置生效，必须再做一件事，看如下示例，注意看注释</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// 调用params.Validation 函数进行验证</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">Validation</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token operator">&amp;</span>param<span class="token punctuation">,</span> param<span class="token punctuation">)</span>
<span class="token comment">// 当返回的不是SUCCESS，就说明验证没通过</span>
<span class="token keyword">if</span> result <span class="token operator">!=</span> params<span class="token punctuation">.</span>SUCCESS <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">SendErrorMsg</span><span class="token punctuation">(</span><span class="token number">1128</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token comment">// 还有一步到位的方法，调用params.ToStructAndValidation函数</span>
<span class="token comment">// 提取参数+数据验证，一步到位</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">ToStructAndValidation</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token operator">&amp;</span>param<span class="token punctuation">,</span> param<span class="token punctuation">)</span>
<span class="token keyword">if</span> result <span class="token operator">!=</span> params<span class="token punctuation">.</span>SUCCESS <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">SendErrorMsg</span><span class="token punctuation">(</span><span class="token number">1128</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="响应数据"><a href="#响应数据" class="header-anchor">#</a> 响应数据</h3> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// 返回json给客户端</span>
res<span class="token punctuation">.</span><span class="token function">SendJson</span><span class="token punctuation">(</span><span class="token string">&quot;json&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// 返回纯文本给客户端</span>
res<span class="token punctuation">.</span><span class="token function">SendText</span><span class="token punctuation">(</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// 返回html页面给客户端</span>
res<span class="token punctuation">.</span><span class="token function">SendHtml</span><span class="token punctuation">(</span><span class="token string">&quot;html text&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// 返回文件流给客户端</span>
res<span class="token punctuation">.</span><span class="token function">SendStream</span><span class="token punctuation">(</span><span class="token string">&quot;filename&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span>

<span class="token comment">// 返回其他自定义content-type的数据给客户端</span>
res<span class="token punctuation">.</span><span class="token function">SendData</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="拦截器"><a href="#拦截器" class="header-anchor">#</a> 拦截器</h3> <ul><li>创建拦截器，跟创建路由特别像，直接调用 route.AddInterceptor函数即可</li> <li>第一个参数是 要拦截的路由路径，支持 * 通配符</li> <li>第二个参数是一个函数，里面可以实现拦截逻辑</li> <li>如果予以放行，直接返回SUCCESS，否则直接返回 提示信息</li> <li>跟路由一样，需要在main函数里调用一下 CreateInterceptor 函数</li></ul> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// 需要在main函数里调用一下这个函数</span>
<span class="token keyword">func</span> <span class="token function">CreateInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	route<span class="token punctuation">.</span><span class="token function">AddInterceptor</span><span class="token punctuation">(</span><span class="token string">&quot;/example/*&quot;</span><span class="token punctuation">,</span> loginInterceptorBefore<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">loginInterceptorBefore</span><span class="token punctuation">(</span>req <span class="token operator">*</span>commons<span class="token punctuation">.</span>BeeRequest<span class="token punctuation">,</span> res <span class="token operator">*</span>commons<span class="token punctuation">.</span>BeeResponse<span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
	res<span class="token punctuation">.</span><span class="token function">SetHeader</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello word&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetHeader</span><span class="token punctuation">(</span><span class="token string">&quot;hello2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;word2&quot;</span><span class="token punctuation">)</span>

	log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;exec interceptor&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> params<span class="token punctuation">.</span>SUCCESS
<span class="token punctuation">}</span>
</code></pre></div><h3 id="会话管理"><a href="#会话管理" class="header-anchor">#</a> 会话管理</h3> <p>需要先创建一个session</p> <ul><li>Secret: 加密秘钥，长度必须=32</li> <li>InitializationVector: 初始化常量，长度必须=16</li> <li>Timeout: 有效时长，单位毫秒</li></ul> <div class="language-go extra-class"><pre class="language-go"><code>session <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>commons<span class="token punctuation">.</span>BeeSession<span class="token punctuation">)</span>
session<span class="token punctuation">.</span>Secret <span class="token operator">=</span> <span class="token string">&quot;12345678abcdefgh09876543alnkdjfh&quot;</span>
session<span class="token punctuation">.</span>InitializationVector <span class="token operator">=</span> <span class="token string">&quot;12345678qwertyui&quot;</span>
session<span class="token punctuation">.</span>Timeout <span class="token operator">=</span> <span class="token number">3000</span>
</code></pre></div><p>然后可以用session创建token</p> <ul><li>将token给前端，前端每次请求都带回来即可</li></ul> <div class="language-go extra-class"><pre class="language-go"><code>demo <span class="token operator">:=</span> Demo<span class="token punctuation">{</span><span class="token punctuation">}</span>
demo<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;Beerus&quot;</span>
demo<span class="token punctuation">.</span>Age <span class="token operator">=</span> <span class="token number">18</span>
demo<span class="token punctuation">.</span>Height <span class="token operator">=</span> <span class="token number">180</span>

token<span class="token punctuation">,</span> err <span class="token operator">:=</span> session<span class="token punctuation">.</span><span class="token function">CreateToken</span><span class="token punctuation">(</span>demo<span class="token punctuation">)</span>
</code></pre></div><p>将token还原成原来的数据</p> <div class="language-go extra-class"><pre class="language-go"><code>demo2 <span class="token operator">:=</span> Demo<span class="token punctuation">{</span><span class="token punctuation">}</span>
err <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">RestoreToken</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> <span class="token operator">&amp;</span>demo2<span class="token punctuation">)</span>
</code></pre></div><p><a href="/cn/beerus/session.html">原理介绍</a></p> <h2 id="websocket-服务"><a href="#websocket-服务" class="header-anchor">#</a> WebSocket 服务</h2> <h3 id="创建路由-2"><a href="#创建路由-2" class="header-anchor">#</a> 创建路由</h3> <ul><li>这里为了偷懒只用了三个函数，实际操作中可以 每个路由对应三个不同的函数</li> <li>第一个参数session: 里面就两个元素，一个ID，一个 SendString，Send 函数</li> <li>第二个参数msg: 是客户端发来的消息，直接用即可</li></ul> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// CreateWebSocketRoute Creating websocket routes</span>
<span class="token keyword">func</span> <span class="token function">CreateWebSocketRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	wroute<span class="token punctuation">.</span><span class="token function">AddWebSocketRoute</span><span class="token punctuation">(</span><span class="token string">&quot;/ws/test&quot;</span><span class="token punctuation">,</span> onConnection<span class="token punctuation">,</span> onMessage<span class="token punctuation">,</span> onClose<span class="token punctuation">)</span>
	wroute<span class="token punctuation">.</span><span class="token function">AddWebSocketRoute</span><span class="token punctuation">(</span><span class="token string">&quot;/ws/test2&quot;</span><span class="token punctuation">,</span> onConnection<span class="token punctuation">,</span> onMessage<span class="token punctuation">,</span> onClose<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// In order to save time, only three functions are used below. In practice, you can configure a set of functions for each route</span>

<span class="token keyword">func</span> <span class="token function">onConnection</span><span class="token punctuation">(</span>session <span class="token operator">*</span>wparams<span class="token punctuation">.</span>WebSocketSession<span class="token punctuation">,</span> msg <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span>msg <span class="token operator">+</span> <span class="token string">&quot;-------------------------------&quot;</span><span class="token punctuation">)</span>
	session<span class="token punctuation">.</span><span class="token function">SendString</span><span class="token punctuation">(</span><span class="token string">&quot;connection success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">onMessage</span><span class="token punctuation">(</span>session <span class="token operator">*</span>wparams<span class="token punctuation">.</span>WebSocketSession<span class="token punctuation">,</span> msg <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span>msg <span class="token operator">+</span> <span class="token string">&quot;-------------------------------&quot;</span><span class="token punctuation">)</span>
	session<span class="token punctuation">.</span><span class="token function">SendString</span><span class="token punctuation">(</span><span class="token string">&quot;I got the message.&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">onClose</span><span class="token punctuation">(</span>session <span class="token operator">*</span>wparams<span class="token punctuation">.</span>WebSocketSession<span class="token punctuation">,</span> msg <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span>msg <span class="token operator">+</span> <span class="token string">&quot;-------------------------------&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="启动服务-2"><a href="#启动服务-2" class="header-anchor">#</a> 启动服务</h3> <p>需要手动调用一下 创建路由的函数，启动的服务依然是HTTP服务</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    
    <span class="token comment">// Interceptors, routes, etc. Loading of data requires its own calls</span>
    routes<span class="token punctuation">.</span><span class="token function">CreateWebSocketRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">// Listen the service and listen to port 8080</span>
    beerus<span class="token punctuation">.</span><span class="token function">ListenHTTP</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>启动后 前端就可以正常的发起WebSocket通讯了，连接方式: ws://ip:port/路由路径</p> <h2 id="udp服务"><a href="#udp服务" class="header-anchor">#</a> UDP服务</h2> <h3 id="启动服务-3"><a href="#启动服务-3" class="header-anchor">#</a> 启动服务</h3> <ul><li>不存在路由的概念，只有一个函数用来接收数据</li> <li>第一个参数就是 这个接收数据的函数</li> <li>第二个参数是结束符，用来标识数据读到哪 才算一个消息读完了</li> <li>第三个参数就是端口号</li></ul> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token comment">// Listening to a UDP service</span>
	<span class="token comment">// The first parameter is the handler</span>
	<span class="token comment">// The second parameter is the data separator</span>
	<span class="token comment">// The third parameter is the port</span>
	beerus<span class="token punctuation">.</span><span class="token function">ListenUDP</span><span class="token punctuation">(</span>updHandler<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;|&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">updHandler</span><span class="token punctuation">(</span>data <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// data is the data you received</span>
	<span class="token function">println</span><span class="token punctuation">(</span>util<span class="token punctuation">.</span><span class="token function">BytesToString</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>接收到数据以后，直接转成string即可</p> <h2 id="数据库操作"><a href="#数据库操作" class="header-anchor">#</a> 数据库操作</h2> <p><a href="/cn/beerusdb/index.html">点击此处-&gt;跳转到数据库操作</a></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/cn/assets/js/app.fb26b1ce.js" defer></script><script src="/cn/assets/js/2.67bc9379.js" defer></script><script src="/cn/assets/js/8.282612f2.js" defer></script>
  </body>
</html>
